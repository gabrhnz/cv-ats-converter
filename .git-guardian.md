# ğŸ›¡ï¸ Git Guardian - ProtecciÃ³n de Secretos

## âœ… Instalado y Configurado

**Herramienta**: git-secrets  
**Estado**: âœ… Activo  
**Fecha**: 14 de Octubre, 2025

---

## ğŸ”’ Protecciones Activas

### Hooks Instalados
- âœ… `pre-commit` - Escanea antes de cada commit
- âœ… `commit-msg` - Valida mensajes de commit
- âœ… `prepare-commit-msg` - Prepara mensajes seguros

### Patrones Detectados

1. **OpenRouter API Keys**
   - `sk-or-v1-[a-zA-Z0-9]{64}`
   - `OPENROUTER_API_KEY=sk-...`

2. **AWS Keys**
   - `AKIA[0-9A-Z]{16}`

3. **GitHub Tokens**
   - `ghp_...` (Personal Access Tokens)
   - `gho_...` (OAuth Tokens)

4. **Vercel Tokens**
   - `vercel.*token`

5. **Private Keys**
   - `-----BEGIN PRIVATE KEY-----`

6. **Generic Secrets**
   - `API_KEY="..."`
   - `SECRET="..."`
   - `PASSWORD="..."`

---

## ğŸ§ª Probar la ProtecciÃ³n

```bash
# Esto deberÃ­a FALLAR (bloqueado por git-secrets)
echo "OPENROUTER_API_KEY=sk-or-v1-test123" > test.txt
git add test.txt
git commit -m "test"

# VerÃ¡s un error como:
# test.txt:1:OPENROUTER_API_KEY=sk-or-v1-test123
# [ERROR] Matched one or more prohibited patterns
```

---

## ğŸ”§ Comandos Ãštiles

### Escanear Repositorio Completo
```bash
git secrets --scan
```

### Escanear Historial
```bash
git secrets --scan-history
```

### Listar Patrones Configurados
```bash
git secrets --list
```

### Agregar Nuevo PatrÃ³n
```bash
git secrets --add 'patron-regex'
```

### Agregar PatrÃ³n Permitido (Whitelist)
```bash
git secrets --add --allowed 'patron-permitido'
```

---

## ğŸ“‹ Archivos Siempre Ignorados

Estos archivos estÃ¡n en `.gitignore` y NUNCA se subirÃ¡n:

- `.env` - Variables de entorno locales
- `.env.local` - Variables locales
- `.env.production` - Variables de producciÃ³n
- `*.key` - Archivos de llaves
- `*.pem` - Certificados
- `secrets/` - Directorio de secretos

---

## ğŸš¨ Si Detecta un Secreto

### El commit serÃ¡ BLOQUEADO con un mensaje como:

```
test.txt:1:OPENROUTER_API_KEY=sk-or-v1-abc123...

[ERROR] Matched one or more prohibited patterns

Possible mitigations:
- Mark false positives as allowed using: git config --add secrets.allowed ...
- List your configured patterns: git secrets --list
- List your configured allowed patterns: git secrets --list --allowed
```

### QuÃ© Hacer:

1. **NO forzar el commit** con `--no-verify`
2. **Remover el secreto** del archivo
3. **Usar variables de entorno** en su lugar
4. **Verificar** que el secreto no estÃ© en el historial

---

## ğŸ”„ ConfiguraciÃ³n Global (Opcional)

Para aplicar git-secrets a TODOS tus repositorios:

```bash
# Instalar globalmente
git secrets --install ~/.git-templates/git-secrets
git config --global init.templateDir ~/.git-templates/git-secrets

# Registrar patrones globales
git secrets --register-aws --global
git secrets --add --global 'sk-or-v1-[a-zA-Z0-9]{64}'
```

---

## ğŸ“Š Estado de Seguridad

| ProtecciÃ³n | Estado |
|------------|--------|
| **git-secrets** | âœ… Instalado |
| **Pre-commit Hook** | âœ… Activo |
| **Patrones OpenRouter** | âœ… Configurado |
| **Patrones AWS** | âœ… Configurado |
| **Patrones GitHub** | âœ… Configurado |
| **Patrones GenÃ©ricos** | âœ… Configurado |

---

## ğŸ¯ Mejores PrÃ¡cticas

1. âœ… **Nunca** hardcodear API keys en el cÃ³digo
2. âœ… **Siempre** usar variables de entorno
3. âœ… **Verificar** `.gitignore` antes de commits
4. âœ… **Escanear** el repositorio regularmente
5. âœ… **Revocar** inmediatamente si se expone una key
6. âœ… **Rotar** API keys periÃ³dicamente

---

## ğŸ“ En Caso de ExposiciÃ³n

1. **Revocar** la API key inmediatamente
2. **Generar** nueva API key
3. **Actualizar** en Vercel/servicios
4. **Escanear** historial de git
5. **Limpiar** historial si es necesario (git filter-branch)

---

## âœ… VerificaciÃ³n

Para verificar que todo funciona:

```bash
# 1. Escanear repo actual
git secrets --scan

# 2. Probar con un secreto falso
echo "test_key=sk-or-v1-test" > test.txt
git add test.txt
git commit -m "test"
# DeberÃ­a FALLAR âœ…

# 3. Limpiar
rm test.txt
git reset HEAD test.txt
```

---

**Tu repositorio estÃ¡ ahora protegido contra exposiciÃ³n de secretos** ğŸ›¡ï¸

**Ãšltima ActualizaciÃ³n**: 14 de Octubre, 2025  
**VersiÃ³n**: 1.0 (Git Guardian Active)
